# AsQi_API



## Основные компоненты МОДУЛЯ АВТОРИЗАЦИИ src/auth

### `config.py`

Модуль для настройки параметров приложения, таких как секретный ключ, алгоритм шифрования и сроки действия токенов.

### `dao.py`

Модуль database access object, обеспечивает универсальные запросы в БД (не трогать вообще).

### `dependencies.py`

Модуль зависимостей для проверки пользователя.

### `exceptions.py`

Модуль с определением вызываемых ошибок.

### `models.py`

Модуль с определением моделей базы данных, таких как `User`, `Role` и `Refresh_token`, с их полями и отношениями.

### `routers.py`

Модуль с определением роутов.

### `schemas.py`

Модуль с определением схем данных с использованием Pydantic, включая схемы для пользователей, ролей и токенов.

### `service.py`

Модуль для выполнения операций CRUD с записями в базе данных. Определен интерфейс DatabaseManager.

### `utils.py`

Модуль утилит для работы с паролями.


## Запуск проекта


Напишите ./setup_venv.bat

ИЛИ

1. Создайте виртуальное окружение venv (python -m venv venv)
2. Активируйте venv (venv/Scripts/activate)
3. Установите зависимости, указанные в файле `requirements.txt` (pip install -r requirements.txt)
4. Создайте базу данных.
5. Укажите необходимые переменные окружения в файле `.env` в корневой директории AsQi, такие как:

    * DB_HOST=<хост_базы_данных>
    * DB_PORT=<порт_базы_данных>
    * DB_NAME=<имя_базы_данных>
    * DB_USER=<пользователь_базы_данных>
    * DB_PASS=<пароль_пользователя_базы_данных>
    * TOKEN_SECRET_KEY=<ваш_секретный_ключ_для_jwt>
    * ALGORITHM=<алгоритм_шифрования>
    * ACCESS_TOKEN_EXPIRE_MINUTES=<срок_действия_токена_доступа_в_минутах>
    * REFRESH_TOKEN_EXPIRE_DAYS=<срок_действия_токена_обновления_в_днях>
    * MIN_USERNAME_LENGTH =<минимальная длина поля username>
    * MAX_USERNAME_LENGTH =<максимальная длина поля username>
    * MIN_PASSWORD_LENGTH =<минимальная длина поля password>
    * MAX_PASSWORD_LENGTH =<максимальная длина поля password>

6. Проведите миграции, для заполнения полями вашей базы. (alembic upgrade head)
7. Запустите приложение с помощью команды: `uvicorn main:app --reload --port 4200`

## Пример использования

Примеры использования эндпоинтов можно найти в файле `routers.py`. ВАЖНО! СНАЧАЛА необходимо создать роли, а уже ПОТОМ пользователей.

## Зависимости

Полный список зависимостей указан в файле `requirements.txt`.
Основной стек [`FastAPI`, `sqlalchemy`, `Pydantic`, `alembic`, `postgresql`]